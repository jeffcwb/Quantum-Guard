<!DOCTYPE html>
<html lang="pt-br" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>QuantumGuard | Enterprise Wallet Security</title>
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="strict-origin">
    <meta name="theme-color" content="#05070a">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyan: { 400: '#22d3ee', 500: '#06b6d4', 900: '#164e63' },
                        slate: { 800: '#1e293b', 900: '#0f172a' },
                    },
                    fontFamily: {
                        mono: ['JetBrains Mono', 'monospace'],
                        orbitron: ['Orbitron', 'sans-serif'],
                        inter: ['Inter', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'flow-gradient': 'flow 3s linear infinite',
                    },
                    keyframes: {
                        flow: { '0%, 100%': { backgroundPosition: '0% 50%' }, '50%': { backgroundPosition: '100% 50%' } },
                    }
                }
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/tokyo-night-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=JetBrains+Mono:wght@300;400;500&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

    <style>
        /* ─── CORE STYLES ─── */
        body { background-color: #05070a; color: #e2e8f0; font-family: 'Inter', sans-serif; overflow-x: hidden; position: relative; }
        
        /* Blooms */
        body::before { content: ''; position: fixed; top: -20%; left: -10%; width: 60%; height: 60%; background: radial-gradient(circle, rgba(6, 182, 212, 0.15) 0%, rgba(0,0,0,0) 70%); filter: blur(120px); z-index: -2; pointer-events: none; }
        body::after { content: ''; position: fixed; bottom: -20%; right: -10%; width: 60%; height: 60%; background: radial-gradient(circle, rgba(59, 130, 246, 0.15) 0%, rgba(0,0,0,0) 70%); filter: blur(120px); z-index: -2; pointer-events: none; }
        #particle-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; opacity: 0.6; }
        
        /* Glass Panel */
        .glass-panel {
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(34, 211, 238, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36), inset 0 0 0 1px rgba(255, 255, 255, 0.05);
            border-radius: 20px; transition: all 0.3s ease; position: relative; overflow: hidden;
        }
        .glass-panel:hover { border-color: rgba(34, 211, 238, 0.25); box-shadow: 0 8px 40px rgba(6, 182, 212, 0.15), inset 0 0 0 1px rgba(255, 255, 255, 0.1); }

        /* Tech Components */
        .btn-tech-primary {
            background-size: 200% auto;
            background-image: linear-gradient(to right, #06b6d4 0%, #3b82f6 50%, #06b6d4 100%);
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.3); border: none; position: relative; z-index: 1; overflow: hidden;
        }
        .btn-tech-primary:hover { box-shadow: 0 0 30px rgba(6, 182, 212, 0.5); }
        .input-tech {
            background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(34, 211, 238, 0.2);
            transition: all 0.3s; box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }
        .input-tech:focus { border-color: rgba(34, 211, 238, 0.6); box-shadow: 0 0 15px rgba(34, 211, 238, 0.2), inset 0 2px 4px rgba(0,0,0,0.2); outline: none; }
        
        /* Tech Pill */
        .tech-pill {
            background: rgba(34, 211, 238, 0.05); border: 1px solid rgba(34, 211, 238, 0.2);
            padding: 4px 12px; border-radius: 999px; font-family: 'JetBrains Mono'; font-size: 10px;
            display: flex; align-items: center; gap: 6px;
        }
        .indicator-dot { width: 6px; height: 6px; border-radius: 50%; box-shadow: 0 0 6px currentColor; }

        /* ─── MODAL FIX DEFINITIVO (V3.5) ─── */
        .modal-overlay { 
            position: fixed; inset: 0; 
            background: rgba(5, 7, 10, 0.0);
            backdrop-filter: blur(0px);
            z-index: 100; 
            display: none; align-items: center; justify-content: center; 
            transition: all 0.4s ease;
            pointer-events: none;
            padding: 20px; /* Margem de segurança */
        }
        .modal-overlay.open { 
            display: flex; 
            background: rgba(5, 7, 10, 0.85); 
            backdrop-filter: blur(8px); 
            pointer-events: auto;
        }
        
        .modal-content { 
            width: 100%; max-width: 650px; 
            /* Altura fixa dinâmica segura */
            height: 85dvh; 
            max-height: 800px;
            
            /* FLEX COLUMN: Garante que o header fica fixo e só o texto rola */
            display: flex;
            flex-direction: column;

            border: 1px solid rgba(34, 211, 238, 0.2);
            opacity: 0; transform: scale(1.3); filter: blur(15px);
            transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1);
        }
        
        .modal-overlay.open .modal-content { 
            opacity: 1; transform: scale(1); filter: blur(0);
        }

        /* ÁREA DE SCROLL INTERNA */
        .modal-scroll-area {
            flex-grow: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch; /* Smooth scroll no iOS */
            padding: 2rem;
            padding-bottom: 4rem; /* Respiro final extra */
        }

        .live-ticker { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(5, 7, 10, 0.9); border-top: 1px solid rgba(34, 211, 238, 0.15); padding: 8px 0; z-index: 50; display: flex; overflow: hidden; backdrop-filter: blur(10px); }
        .ticker-content { display: flex; gap: 40px; animation: tickerScroll 30s linear infinite; white-space: nowrap; }
        @keyframes tickerScroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        
        #quantum-canvas { width: 100%; height: 36px; border-radius: 8px; border: 1px solid rgba(34, 211, 238, 0.3); image-rendering: pixelated; opacity: 0.9; box-shadow: 0 0 10px rgba(34, 211, 238, 0.1); }
        ::-webkit-scrollbar { width: 5px; height: 5px; } ::-webkit-scrollbar-track { background: rgba(15, 23, 42, 0.5); } ::-webkit-scrollbar-thumb { background: rgba(34, 211, 238, 0.3); border-radius: 10px; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-8 pb-24 selection:bg-cyan-500/20 selection:text-cyan-100 font-inter">

    <canvas id="particle-canvas"></canvas>

    <header class="w-full max-w-3xl px-6 flex flex-col md:flex-row justify-between items-center mb-10 relative z-10 animate-in fade-in slide-in-from-top-4 duration-700 gap-6 md:gap-0">
        <div class="flex items-center gap-4 group cursor-default">
            <div class="relative w-10 h-10 flex items-center justify-center">
                <div class="absolute inset-0 bg-cyan-500/20 rounded-xl rotate-45 group-hover:rotate-90 transition-transform duration-700 blur-md"></div>
                <div class="relative z-10 w-full h-full glass-panel rounded-xl flex items-center justify-center border-cyan-500/30 group-hover:border-cyan-400 transition-colors">
                     <svg class="w-5 h-5 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20.618 5.984A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016zM12 9v2m0 4h.01"/></svg>
                </div>
            </div>
            <div>
                <h1 class="orbitron font-bold text-xl tracking-wider text-white flex items-center gap-2">
                    QUANTUM<span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">GUARD</span>
                </h1>
                <p class="text-[10px] text-cyan-300/60 font-mono tracking-[0.3em] uppercase pl-0.5">Enterprise Entropy Protocol</p>
            </div>
        </div>
        
        <div class="flex flex-col md:flex-row items-center gap-3 w-full md:w-auto">
            <!-- Links Sociais -->
            <div class="flex items-center gap-2">
                <a href="https://github.com/jeffcwb/Quantum-Guard" target="_blank" rel="noopener" class="group relative p-2 rounded-lg glass-panel border-slate-700/50 hover:border-cyan-500/50 transition-all hover:shadow-[0_0_15px_rgba(6,182,212,0.2)]" title="GitHub Repository">
                    <svg class="w-4 h-4 text-slate-400 group-hover:text-cyan-400 transition-colors" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                </a>
                <a href="https://twitter.com/" target="_blank" rel="noopener" class="group relative p-2 rounded-lg glass-panel border-slate-700/50 hover:border-blue-500/50 transition-all hover:shadow-[0_0_15px_rgba(59,130,246,0.2)]" title="Twitter/X">
                    <svg class="w-4 h-4 text-slate-400 group-hover:text-blue-400 transition-colors" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                </a>
                <a href="mailto:quantumguard@outlook.com" class="group relative p-2 rounded-lg glass-panel border-slate-700/50 hover:border-purple-500/50 transition-all hover:shadow-[0_0_15px_rgba(168,85,247,0.2)]" title="Contact Email">
                    <svg class="w-4 h-4 text-slate-400 group-hover:text-purple-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
                </a>
            </div>

            <!-- Botões de Ação -->
            <div class="flex items-center gap-2">
                <button onclick="openAboutModal()" class="flex text-[10px] font-bold text-cyan-300 tracking-widest uppercase transition-all px-3 py-2 border border-cyan-500/30 bg-cyan-950/20 rounded-lg hover:bg-cyan-500/10 hover:border-cyan-400 hover:shadow-[0_0_15px_rgba(6,182,212,0.3)]">
                    Manifesto
                </button>
                <button onclick="openSecurityModal()" class="group flex items-center gap-2 px-3 py-2 rounded-lg glass-panel hover:bg-cyan-900/20 transition-all text-xs text-cyan-100/80 border-cyan-500/20 cursor-pointer">
                    <span class="relative flex h-2 w-2">
                      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                      <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)]"></span>
                    </span>
                    <span class="group-hover:text-white transition-colors font-medium orbitron tracking-wide text-[10px]">Auditoria</span>
                </button>
            </div>
        </div>
    </header>

    <main class="w-full max-w-xl relative z-10 px-4 space-y-8 animate-in fade-in duration-1000 delay-300">

        <div class="text-center relative">
            <h2 class="orbitron text-2xl md:text-3xl font-bold text-white mb-4 leading-tight">
                Segurança de Chaves<br>via <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-500 animate-flow-gradient background-size-200">Vácuo Quântico.</span>
            </h2>
            <p class="text-sm text-gray-400 leading-relaxed max-w-md mx-auto mb-8 font-light">
                Elimine vetores de ataque PRNG. Utilizamos flutuações físicas reais (ANU Labs) combinadas com entropia local do seu navegador para gerar Seeds BIP-39.
            </p>
            <div class="flex flex-wrap justify-center gap-4 mb-8">
                <div class="tech-pill text-cyan-300"><span class="indicator-dot bg-cyan-400 animate-pulse-slow"></span>Solana Mainnet Verifier</div>
                <div class="tech-pill text-blue-300"><span class="indicator-dot bg-blue-400 animate-pulse-slow"></span>ANU Quantum Link</div>
                <div class="tech-pill text-purple-300"><span class="indicator-dot bg-purple-400 animate-pulse-slow"></span>Zero-Knowledge Arch</div>
            </div>
        </div>

        <div class="glass-panel p-6 relative overflow-hidden">
            <div class="absolute top-0 right-0 p-4 opacity-20"><svg class="w-16 h-16 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></div>
            <h3 class="orbitron text-sm text-white mb-6 flex items-center gap-2">
                <svg class="w-4 h-4 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path></svg>
                Especificações do Protocolo
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="glass-panel p-4 bg-slate-900/30 border-slate-700/50 hover:border-cyan-500/30 transition cursor-default group">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="p-1.5 rounded-md bg-cyan-950 text-cyan-400 group-hover:text-cyan-300 transition"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>
                        <span class="text-xs font-semibold text-gray-200">Entropia Híbrida</span>
                    </div>
                    <p class="text-[10px] text-gray-500 leading-relaxed">Hardware Quântico (Server) + Ruído do Sistema (Client). Impossível de prever.</p>
                </div>
                
                <button onclick="openCodeModal()" class="glass-panel p-4 bg-slate-900/30 border-slate-700/50 hover:border-blue-500/50 transition text-left group relative overflow-hidden">
                     <div class="absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition duration-500"></div>
                    <div class="flex items-center justify-between mb-2 relative z-10">
                        <div class="flex items-center gap-3">
                            <div class="p-1.5 rounded-md bg-blue-950 text-blue-400 group-hover:text-blue-300 transition"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></div>
                            <span class="text-xs font-semibold text-gray-200">Transparência de Código</span>
                        </div>
                        
                        <div class="relative px-3 py-1.5 rounded bg-blue-950/40 border border-blue-500/30 flex items-center gap-2 group-hover:bg-blue-900/40 group-hover:border-blue-400 transition-all duration-300 shadow-[0_0_10px_rgba(59,130,246,0.05)] group-hover:shadow-[0_0_15px_rgba(59,130,246,0.2)]">
                            <span class="relative flex h-1.5 w-1.5">
                              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
                              <span class="relative inline-flex rounded-full h-1.5 w-1.5 bg-blue-500"></span>
                            </span>
                            <span class="text-[9px] font-mono font-bold text-blue-300 group-hover:text-white tracking-wider">AUDIT_CODE</span>
                            <svg class="w-3 h-3 text-blue-400 group-hover:text-white group-hover:translate-x-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </div>
                    </div>
                    <p class="text-[10px] text-gray-500 leading-relaxed relative z-10">A derivação da chave (BIP-39) ocorre 100% no seu navegador. Clique para auditar.</p>
                </button>
            </div>
        </div>

        <div id="step-input" class="glass-panel p-8 animate-in fade-in slide-in-from-bottom-4 duration-700">
            <!-- Header com Status -->
            <div class="flex justify-between items-center mb-6 pb-4 border-b border-cyan-900/30">
                <div class="flex items-center gap-2">
                    <span class="relative flex h-2 w-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-cyan-400 opacity-75"></span><span class="relative inline-flex rounded-full h-2 w-2 bg-cyan-500"></span></span>
                    <span class="text-xs font-bold text-cyan-100 orbitron tracking-wider">SISTEMA ATIVO</span>
                </div>
            </div>

            <!-- Título Principal da Seção -->
            <div class="text-center mb-8">
                <h3 class="text-lg font-bold text-white orbitron mb-2">Como Gerar Sua Carteira Segura</h3>
                <p class="text-xs text-slate-400 font-inter">Siga os 3 passos abaixo para criar sua seed phrase quântica</p>
            </div>

            <!-- PASSO 1: Valor do Pagamento (DESTAQUE MÁXIMO) -->
            <div class="mb-6 glass-panel p-6 bg-gradient-to-br from-cyan-950/40 to-blue-950/40 border-2 border-cyan-500/40 relative overflow-hidden">
                <div class="absolute top-0 right-0 w-32 h-32 bg-cyan-500/10 rounded-full blur-3xl"></div>
                <div class="relative z-10">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="flex items-center justify-center w-8 h-8 rounded-full bg-cyan-500 text-white font-bold orbitron text-sm">1</div>
                        <span class="text-sm font-bold text-white orbitron tracking-wide">VALOR DO PAGAMENTO</span>
                    </div>
                    <div class="flex items-baseline gap-3 mb-3">
                        <div class="flex items-center gap-2">
                            <svg class="w-8 h-8 text-cyan-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                            <span class="text-5xl font-bold text-white orbitron">0.05</span>
                            <span class="text-2xl font-bold text-cyan-400 orbitron">SOL</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 text-xs text-cyan-300/80 font-mono">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                        <span>Envie <strong>exatamente este valor</strong> para a carteira abaixo via Solana Mainnet</span>
                    </div>
                </div>
            </div>

            <!-- PASSO 2: Carteira de Destino -->
            <div class="mb-6 font-mono">
                <div class="flex items-center gap-3 mb-3">
                    <div class="flex items-center justify-center w-8 h-8 rounded-full bg-slate-700 text-white font-bold orbitron text-sm">2</div>
                    <label class="text-sm font-bold text-white orbitron tracking-wide">ENDEREÇO DE DESTINO</label>
                </div>
                <div class="glass-panel p-4 bg-slate-900/60 border-slate-700">
                    <div class="flex items-center gap-3 mb-3">
                        <code class="flex-1 text-xs text-cyan-100 break-all select-all font-mono" id="wallet-address">C4rCXahq6znedaKcKRSeqtitwE1kR97d7yYfY2WxrXJ</code>
                        <button onclick="copyWallet()" class="shrink-0 btn-tech-primary px-4 py-2 rounded-lg text-xs text-white font-bold hover:text-cyan-50 transition-colors flex items-center gap-2 group">
                            <svg class="w-4 h-4 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                            COPIAR
                        </button>
                    </div>
                    <div class="flex items-start gap-2 p-3 bg-amber-950/30 border border-amber-700/30 rounded-lg">
                        <svg class="w-4 h-4 text-amber-400 shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
                        <p class="text-[10px] text-amber-200/90 leading-relaxed">
                            <strong>IMPORTANTE:</strong> Use Phantom, Solflare, ou qualquer wallet Solana. Certifique-se de estar na <strong>Mainnet</strong> (não Devnet).
                        </p>
                    </div>
                </div>
            </div>

            <!-- PASSO 3: Hash da Transação -->
            <div class="mb-6 font-mono">
                <div class="flex items-center gap-3 mb-3">
                    <div class="flex items-center justify-center w-8 h-8 rounded-full bg-slate-700 text-white font-bold orbitron text-sm">3</div>
                    <label class="text-sm font-bold text-white orbitron tracking-wide">HASH DA TRANSAÇÃO</label>
                </div>
                <div class="relative">
                    <input type="text" id="txSignature" placeholder="Cole aqui o hash/signature após enviar o pagamento..." 
                        class="w-full input-tech rounded-lg p-4 pr-12 text-xs text-white placeholder-slate-500 outline-none transition-all focus:pl-4 pl-4 font-mono">
                    <svg class="w-5 h-5 text-slate-500 absolute right-4 top-4 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path></svg>
                </div>
                <div class="mt-2 flex items-start gap-2 text-[10px] text-slate-400">
                    <svg class="w-3 h-3 shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                    <span>Encontre o hash/signature na confirmação da sua wallet. Parece com: <code class="text-cyan-400">5Kq7x...</code></span>
                </div>
            </div>

            <!-- Botão de Validação -->
            <button onclick="verifyAndGenerate()" class="w-full btn-tech-primary py-5 rounded-xl font-bold text-white text-sm orbitron tracking-wider mt-6 group hover:animate-flow-gradient shadow-lg shadow-cyan-500/20 hover:shadow-cyan-500/40 transition-all">
                <span class="flex items-center justify-center gap-3">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                    VALIDAR PAGAMENTO & GERAR CARTEIRA
                    <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                </span>
            </button>

            <!-- Nota de Segurança Final -->
            <div class="mt-6 p-4 bg-slate-900/40 border border-slate-700/50 rounded-lg">
                <div class="flex items-start gap-3">
                    <svg class="w-5 h-5 text-green-400 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
                    <div>
                        <p class="text-xs font-bold text-green-300 mb-1">Processamento 100% Client-Side</p>
                        <p class="text-[10px] text-slate-400 leading-relaxed">Sua seed phrase é gerada localmente no seu navegador. Nunca é enviada ao servidor. Você tem controle total.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="loading-screen" class="hidden absolute inset-0 glass-panel z-50 flex flex-col items-center justify-center bg-[#05070a]/95 backdrop-blur-xl">
            <div class="relative w-20 h-20 mb-6">
                <div class="absolute inset-0 rounded-full border-t-2 border-cyan-400 animate-spin"></div>
                <div class="absolute inset-2 rounded-full border-r-2 border-blue-500 animate-spin-slow"></div>
            </div>
            <p class="orbitron text-cyan-300 text-sm tracking-widest animate-pulse mb-6">ESTABELECENDO LINK QUÂNTICO</p>
            <div id="loading-logs" class="font-mono text-[10px] text-cyan-500/70 text-left space-y-1.5 h-24 w-64 overflow-hidden"></div>
        </div>

        <div id="step-result" class="hidden space-y-6 animate-in zoom-in-95 duration-500">
            <div class="glass-panel p-4 bg-red-950/30 border-red-900/50 flex gap-4 items-center relative overflow-hidden">
                <div class="absolute inset-0 bg-red-500/5 animate-pulse-slow pointer-events-none"></div>
                <div class="p-2 bg-red-900/50 rounded-full border border-red-800/50 relative z-10">
                    <svg class="w-6 h-6 text-red-400 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                </div>
                <div class="relative z-10">
                    <p class="text-xs font-bold text-red-300 orbitron tracking-wide mb-1">SESSÃO DE ALTA SEGURANÇA</p>
                    <p class="text-[10px] text-red-200/70 font-mono leading-relaxed">Dados voláteis na RAM. Auto-destruição em: <span id="timer" class="text-red-400 font-bold text-sm ml-1">5:00</span></p>
                </div>
            </div>

            <div class="glass-panel p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="orbitron text-xs text-white tracking-wider flex items-center gap-2">
                        <svg class="w-4 h-4 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path></svg>
                        Seed Phrase (BIP-39)
                    </h3>
                    <span class="text-[9px] font-mono text-cyan-500/60 px-2 py-1 rounded bg-cyan-950/30 border border-cyan-900/30">Mnemonic 12-Words</span>
                </div>
                <div id="seed-grid" class="grid grid-cols-2 sm:grid-cols-3 gap-3 font-mono text-[11px]"></div>
            </div>

            <div class="glass-panel p-5">
                 <h3 class="orbitron text-xs text-white tracking-wider mb-4 flex items-center gap-2">
                    <svg class="w-4 h-4 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                    Relatório de Integridade Quântica
                </h3>
                <div class="grid grid-cols-2 gap-4 mb-4 font-mono">
                    <div class="bg-slate-900/40 p-3 rounded-lg border border-slate-800/50">
                        <span class="text-[9px] text-slate-500 block mb-1">FONTE PRIMÁRIA</span>
                        <span id="source-tag" class="text-[10px] text-cyan-300 font-semibold flex items-center gap-1.5"><span class="indicator-dot bg-cyan-400 animate-pulse-slow"></span> --</span>
                    </div>
                     <div class="bg-slate-900/40 p-3 rounded-lg border border-slate-800/50">
                        <span class="text-[9px] text-slate-500 block mb-1">LATÊNCIA DE REDE</span>
                        <span id="latency-tag" class="text-[10px] text-blue-300 font-semibold">-- ms</span>
                    </div>
                     <div class="bg-slate-900/40 p-3 rounded-lg border border-slate-800/50 col-span-2">
                        <div class="flex justify-between items-end mb-2">
                            <span class="text-[9px] text-slate-500 block">ENTROPIA DE SHANNON (BITS)</span>
                             <span id="entropy-score" class="text-[10px] text-green-400 font-bold">--</span>
                        </div>
                        <div class="relative h-10 w-full rounded-md overflow-hidden border border-cyan-900/30">
                            <canvas id="quantum-canvas" class="w-full h-full"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <button onclick="destroySession()" class="w-full glass-panel py-4 text-xs font-bold text-slate-400 hover:text-red-400 hover:border-red-900/50 hover:bg-red-950/20 transition-all orbitron tracking-widest flex items-center justify-center gap-3 group">
                WIPE MEMORY & ENCERRAR SESSÃO
            </button>
        </div>

    </main>

    <!-- Footer Profissional -->
    <footer class="w-full max-w-4xl px-6 mt-16 mb-20 relative z-10">
        <div class="glass-panel p-8 border-slate-800">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-6">
                <!-- Sobre -->
                <div>
                    <h4 class="text-xs font-bold text-cyan-300 orbitron mb-3 tracking-wider">SOBRE O PROJETO</h4>
                    <p class="text-[10px] text-slate-400 leading-relaxed mb-3">
                        Geração de carteiras cripto usando entropia quântica real da Australian National University combinada com aleatoriedade local do navegador.
                    </p>
                    <button onclick="openAboutModal()" class="text-[10px] text-cyan-400 hover:text-cyan-300 transition-colors font-semibold flex items-center gap-1">
                        Leia o manifesto completo
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                    </button>
                </div>

                <!-- Links -->
                <div>
                    <h4 class="text-xs font-bold text-cyan-300 orbitron mb-3 tracking-wider">RECURSOS</h4>
                    <ul class="space-y-2 text-[10px]">
                        <li>
                            <a href="https://github.com/jeffcwb/Quantum-Guard" target="_blank" rel="noopener" class="text-slate-400 hover:text-cyan-400 transition-colors flex items-center gap-2">
                                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                                Código Fonte
                            </a>
                        </li>
                        <li>
                            <button onclick="openCodeModal()" class="text-slate-400 hover:text-cyan-400 transition-colors flex items-center gap-2">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/></svg>
                                Auditoria de Código
                            </button>
                        </li>
                        <li>
                            <button onclick="openSecurityModal()" class="text-slate-400 hover:text-cyan-400 transition-colors flex items-center gap-2">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
                                Verificação de Segurança
                            </button>
                        </li>
                        <li>
                            <a href="https://qrng.anu.edu.au/" target="_blank" rel="noopener" class="text-slate-400 hover:text-cyan-400 transition-colors flex items-center gap-2">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/></svg>
                                ANU Quantum Labs
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Contato -->
                <div>
                    <h4 class="text-xs font-bold text-cyan-300 orbitron mb-3 tracking-wider">CONTATO & COMUNIDADE</h4>
                    <div class="space-y-3">
                        <a href="mailto:quantumguard@outlook.com" class="flex items-center gap-2 text-[10px] text-slate-400 hover:text-purple-400 transition-colors">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
                            quantumguard@outlook.com
                        </a>
                        <div class="flex items-center gap-2">
                            <a href="https://twitter.com/" target="_blank" rel="noopener" class="p-2 rounded-lg glass-panel border-slate-700 hover:border-blue-500/50 transition-all group">
                                <svg class="w-4 h-4 text-slate-400 group-hover:text-blue-400 transition-colors" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                            </a>
                            <a href="https://github.com/jeffcwb/Quantum-Guard" target="_blank" rel="noopener" class="p-2 rounded-lg glass-panel border-slate-700 hover:border-cyan-500/50 transition-all group">
                                <svg class="w-4 h-4 text-slate-400 group-hover:text-cyan-400 transition-colors" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Divider -->
            <div class="border-t border-slate-800 pt-6">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <p class="text-[9px] text-slate-500 font-mono text-center md:text-left">
                        © 2026 QuantumGuard Labs. Proprietary Software. 
                        <span class="text-slate-600">|</span>
                        <a href="#" class="hover:text-cyan-400 transition-colors">Terms</a>
                        <span class="text-slate-600">|</span>
                        <a href="#" class="hover:text-cyan-400 transition-colors">Privacy</a>
                    </p>
                    <div class="flex items-center gap-2">
                        <span class="px-2 py-1 rounded bg-slate-900/60 text-[8px] text-slate-500 border border-slate-800 font-mono">ISO 27001</span>
                        <span class="px-2 py-1 rounded bg-slate-900/60 text-[8px] text-slate-500 border border-slate-800 font-mono">NIST SP 800-90B</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <div class="live-ticker">
        <div class="ticker-content" id="ticker-content"></div>
    </div>

    <div id="code-modal" class="modal-overlay" onclick="if(event.target===this)closeModal('code-modal')">
        <div class="modal-content glass-panel p-0 bg-[#0d1117] border-slate-700 overflow-hidden relative">
            <div class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-cyan-500 to-blue-500 flex-shrink-0 z-20"></div>
            <div class="flex justify-between items-center p-4 border-b border-slate-800 bg-[#0d1117] flex-shrink-0">
                <h3 class="orbitron text-xs text-white flex items-center gap-2">Client-Side Logic (Ethers.js)</h3>
                <button onclick="closeModal('code-modal')" class="text-slate-500 hover:text-white transition">&times;</button>
            </div>
            <div class="p-4 bg-[#1a1b26] modal-scroll-area">
                 <pre class="rounded-lg overflow-hidden text-[10px] border border-slate-700/50"><code class="language-javascript" id="code-display" style="background: #1a1b26 !important; padding: 1rem;">
function generateWalletLocally(serverEntropyHex) {
    // 1. Gera entropia local do sistema (mouse, tempo)
    const localEntropyBytes = ethers.utils.randomBytes(16);

    // 2. Prepara a entropia do servidor
    const cleanServerHex = serverEntropyHex.startsWith('0x') ? serverEntropyHex : '0x' + serverEntropyHex;
    const serverBytes = ethers.utils.arrayify(cleanServerHex);

    // 3. MIXAGEM CRIPTOGRÁFICA (XOR)
    const finalEntropyBytes = new Uint8Array(16);
    for(let i = 0; i < 16; i++) {
        finalEntropyBytes[i] = localEntropyBytes[i] ^ serverBytes[i];
    }
    
    // 4. DERIVAÇÃO BIP-39 (Mnemônico)
    const mnemonic = ethers.utils.entropyToMnemonic(finalEntropyBytes);
    return ethers.Wallet.fromMnemonic(mnemonic);
}
                </code></pre>
            </div>
        </div>
    </div>

    <div id="security-modal" class="modal-overlay" onclick="if(event.target===this)closeModal('security-modal')">
        <div class="modal-content glass-panel p-0 bg-slate-950/90 relative overflow-hidden flex flex-col">
             <div class="absolute inset-0 bg-cyan-500/5 pointer-events-none"></div>
             
             <div class="p-6 modal-scroll-area flex flex-col items-center">
                <h3 class="orbitron text-sm text-cyan-300 mb-6 text-center flex justify-center items-center gap-2 relative z-10 shrink-0">
                     <svg class="w-5 h-5 animate-spin-slow text-cyan-400" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                    Diagnóstico de Segurança
                </h3>
                <div id="security-steps" class="space-y-3 font-mono text-[11px] relative z-10 pl-2 w-full">
                    </div>
                <div id="security-success" class="hidden mt-8 text-center animate-in zoom-in duration-300 flex flex-col items-center gap-4 w-full">
                    <div class="inline-flex items-center gap-2 px-4 py-2 bg-green-900/30 border border-green-500/30 rounded-full text-green-400 font-bold text-xs tracking-wider">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        AMBIENTE SEGURO
                    </div>
                    <button onclick="closeModal('security-modal')" class="text-[10px] text-green-300 hover:text-white border border-green-500/50 hover:bg-green-500/20 px-6 py-2 rounded-lg transition-all uppercase tracking-widest font-bold shadow-[0_0_15px_rgba(34,197,94,0.1)] hover:shadow-[0_0_20px_rgba(34,197,94,0.3)]">
                        Fechar Diagnóstico
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="about-modal" class="modal-overlay" onclick="if(event.target===this)closeModal('about-modal')">
        <div class="modal-content glass-panel p-0 bg-[#05070a] border-slate-700 overflow-hidden relative max-w-2xl">
            <div class="relative h-32 bg-gradient-to-b from-cyan-900/20 to-[#05070a] flex items-center justify-center overflow-hidden shrink-0 z-10">
                <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
                <div class="text-center relative z-10 mt-4">
                    <h2 class="orbitron text-2xl text-white font-bold tracking-widest mb-1">QUANTUM<span class="text-cyan-400">GUARD</span> LABS</h2>
                    <p class="text-[10px] font-mono text-cyan-500 uppercase tracking-[0.4em]">Secure Research Division</p>
                </div>
                <button onclick="closeModal('about-modal')" class="absolute top-4 right-4 text-slate-500 hover:text-white transition"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
            </div>

            <div class="p-8 space-y-8 modal-scroll-area bg-[#05070a]">
                
                <div class="border-l-2 border-cyan-500/50 pl-4">
                    <h3 class="text-sm font-bold text-white orbitron mb-2">NOSSA MISSÃO: O FIM DA PREVISIBILIDADE</h3>
                    <p class="text-xs text-slate-400 leading-relaxed font-inter">
                        A maioria das carteiras digitais é gerada por algoritmos pseudo-aleatórios (PRNG) baseados em software. Isso cria padrões matemáticos que supercomputadores futuros poderão quebrar. 
                        <br><br>
                        O <strong>QuantumGuard</strong> nasceu para fechar essa brecha de segurança. Não somos apenas um gerador; somos um <span class="text-cyan-300">canal de entropia física pura</span>. Conectamos o caos imprevisível do universo quântico à segurança dos seus ativos digitais.
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="glass-panel p-4 bg-slate-900/30 border-slate-800 hover:border-cyan-500/30 transition text-center group">
                        <div class="w-10 h-10 mx-auto mb-3 bg-cyan-950/50 rounded-full flex items-center justify-center text-cyan-400 group-hover:text-white transition"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg></div>
                        <h4 class="text-[10px] font-bold text-white mb-1 orbitron">FÍSICA > MATEMÁTICA</h4>
                        <p class="text-[9px] text-slate-500">Não usamos fórmulas. Usamos medições de vácuo quântico em tempo real.</p>
                    </div>
                    <div class="glass-panel p-4 bg-slate-900/30 border-slate-800 hover:border-cyan-500/30 transition text-center group">
                        <div class="w-10 h-10 mx-auto mb-3 bg-cyan-950/50 rounded-full flex items-center justify-center text-cyan-400 group-hover:text-white transition"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg></div>
                        <h4 class="text-[10px] font-bold text-white mb-1 orbitron">ZERO LOG POLICY</h4>
                        <p class="text-[9px] text-slate-500">Infraestrutura "Stateless". Nada é gravado em disco, tudo vive apenas na RAM volátil.</p>
                    </div>
                    <div class="glass-panel p-4 bg-slate-900/30 border-slate-800 hover:border-cyan-500/30 transition text-center group">
                        <div class="w-10 h-10 mx-auto mb-3 bg-cyan-950/50 rounded-full flex items-center justify-center text-cyan-400 group-hover:text-white transition"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg></div>
                        <h4 class="text-[10px] font-bold text-white mb-1 orbitron">CLIENTE SOBERANO</h4>
                        <p class="text-[9px] text-slate-500">O servidor entrega a matéria-prima (entropia). A chave final é forjada no SEU dispositivo.</p>
                    </div>
                </div>

                <div class="border-t border-slate-800 pt-6 text-center">
                    <p class="text-[10px] text-slate-600 font-mono mb-4">
                        "A verdadeira aleatoriedade é o único segredo que a matemática não pode descobrir."
                    </p>
                    <div class="inline-flex gap-4">
                        <span class="px-2 py-1 rounded bg-slate-900 text-[9px] text-slate-500 border border-slate-800">ISO/IEC 27001 COMPLIANT ARCHITECTURE</span>
                        <span class="px-2 py-1 rounded bg-slate-900 text-[9px] text-slate-500 border border-slate-800">NIST SP 800-90B ENTROPY SOURCE</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const BACKEND_URL = window.location.origin;
        const WALLET = "C4rCXahq6znedaKcKRSeqtitwE1kR97d7yYfY2WxrXJ";
        let _sessionId = crypto.randomUUID();

        // 1. TICKER
        const actions = ["Hash Validated", "Entropy Mixed", "Session Wiped", "Block Confirmed", "Quantum Tunnel Active"];
        const ticker = document.getElementById('ticker-content');
        for(let i=0; i<8; i++) {
            const act = actions[Math.floor(Math.random()*actions.length)];
            const hash = Math.random().toString(36).substring(2, 8).toUpperCase();
            const div = document.createElement('div'); div.className = "flex items-center gap-2 text-[10px] text-slate-400 font-mono";
            div.innerHTML = `<span class="text-cyan-500">●</span> ${act}: ID-${hash} <span class="text-slate-800 mx-4">|</span>`;
            ticker.appendChild(div);
        }
        ticker.innerHTML += ticker.innerHTML;

        // 2. MODALS
        function openCodeModal() { document.getElementById('code-modal').classList.add('open'); hljs.highlightAll(); }
        function openAboutModal() { document.getElementById('about-modal').classList.add('open'); }
        function closeModal(id) { document.getElementById(id).classList.remove('open'); }

        // SECURITY AUDIT LOGIC — checks reais no navegador
        function openSecurityModal() {
            const m = document.getElementById('security-modal'), s = document.getElementById('security-steps'), ok = document.getElementById('security-success');
            m.classList.add('open'); s.innerHTML = ''; ok.classList.add('hidden');

            const results = [];

            function addResult(text, passed) {
                const div = document.createElement('div');
                div.className = "flex items-center gap-3 text-slate-300 animate-in slide-in-from-left-2 fade-in duration-300";
                const icon = passed ? '<span class="text-cyan-500 font-bold">✓</span>' : '<span class="text-red-400 font-bold">✗</span>';
                div.innerHTML = `${icon} ${text}`;
                s.appendChild(div);
                const scrollArea = m.querySelector('.modal-scroll-area');
                if(scrollArea) scrollArea.scrollTop = scrollArea.scrollHeight;
                results.push(passed);
            }

            // 1. Protocolo HTTPS
            setTimeout(() => {
                const isHTTPS = window.location.protocol === 'https:';
                addResult(`Protocolo seguro: ${window.location.protocol.replace(':','')}`, isHTTPS);
            }, 500);

            // 2. Domínio verificado
            setTimeout(() => {
                const expectedDomain = 'quantumguardseed.vercel.app';
                const domainOk = window.location.hostname === expectedDomain || window.location.hostname === 'localhost';
                addResult(`Domínio verificado: ${window.location.hostname}`, domainOk);
            }, 1200);

            // 3. Sem iframes suspeitos acessando esta página
            setTimeout(() => {
                const iframeCheck = window.self === window.top;
                addResult(`Contexto isolado (sem iframe externo)`, iframeCheck);
            }, 1900);

            // 4. CSPRNG do navegador disponível
            setTimeout(() => {
                let cspOk = false;
                try { crypto.getRandomValues(new Uint8Array(32)); cspOk = true; } catch(e) {}
                addResult(`Gerador CSPRNG do navegador: ${cspOk ? 'disponível' : 'indisponível'}`, cspOk);
            }, 2600);

            // 5. Ethers.js carregado (necessário para derivação local)
            setTimeout(() => {
                const ethersOk = typeof ethers !== 'undefined' && typeof ethers.utils !== 'undefined';
                addResult(`Biblioteca de derivação BIP-39 carregada`, ethersOk);
            }, 3400);

            // 6. Scripts externos — lista branca
            setTimeout(() => {
                const allowedDomains = ['cdn.tailwindcss.com', 'cdnjs.cloudflare.com', 'fonts.googleapis.com', 'fonts.gstatic.com'];
                const scripts = Array.from(document.querySelectorAll('script[src]'));
                const allWhitelisted = scripts.every(s => {
                    try { return allowedDomains.some(d => new URL(s.src).hostname === d); } catch(e) { return false; }
                });
                addResult(`Scripts externos: ${scripts.length} encontrado(s) — todos na lista branca`, allWhitelisted);
            }, 4200);

            // 7. Conexão com backend verificada
            setTimeout(() => {
                fetch('/health', { method: 'GET' })
                    .then(r => r.json())
                    .then(d => {
                        const backendOk = d.status === 'operational';
                        addResult(`Backend operacional (Supabase: ${d.supabase || 'n/a'})`, backendOk);
                        setTimeout(() => {
                            const allPassed = results.every(r => r === true);
                            if(allPassed) ok.classList.remove('hidden');
                            else {
                                const warn = document.createElement('div');
                                warn.className = "mt-4 text-center text-xs text-red-300 font-mono";
                                warn.innerText = "⚠ Alguns checks falharam. Prossiga com cautela.";
                                s.appendChild(warn);
                            }
                        }, 500);
                    })
                    .catch(() => {
                        addResult(`Conexão com backend`, false);
                        setTimeout(() => {
                            const warn = document.createElement('div');
                            warn.className = "mt-4 text-center text-xs text-red-300 font-mono";
                            warn.innerText = "⚠ Alguns checks falharam. Prossiga com cautela.";
                            s.appendChild(warn);
                        }, 500);
                    });
            }, 4800);
        }

        function copyWallet() {
            navigator.clipboard.writeText(WALLET);
            const btn = event.target.closest('button');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg> COPIADO!';
            btn.classList.add('bg-green-500');
            setTimeout(() => { btn.innerHTML = originalHTML; btn.classList.remove('bg-green-500'); }, 2000);
        }

        // 3. BACKGROUND
        const cvs = document.getElementById('particle-canvas'), ctx = cvs.getContext('2d');
        let w, h; function resize() { w=cvs.width=window.innerWidth; h=cvs.height=window.innerHeight; } window.onresize = resize; resize();
        const parts = Array.from({length: 40}, () => ({ x: Math.random()*w, y: Math.random()*h, vx: (Math.random()-0.5)*0.3, vy: (Math.random()-0.5)*0.3, s: Math.random()*1.5, alpha: Math.random()*0.5 }));
        function draw() {
            ctx.clearRect(0,0,w,h);
            parts.forEach(p => {
                p.x += p.vx; p.y += p.vy; if(p.x<0)p.x=w; if(p.x>w)p.x=0; if(p.y<0)p.y=h; if(p.y>h)p.y=0;
                ctx.beginPath(); ctx.arc(p.x, p.y, p.s, 0, Math.PI*2); ctx.fillStyle = `rgba(34, 211, 238, ${p.alpha})`; ctx.fill();
            });
            requestAnimationFrame(draw);
        } draw();

        // 4. MAIN LOGIC
        async function verifyAndGenerate() {
            const sig = document.getElementById('txSignature').value.trim();
            if(sig.length < 20) { alert("Hash inválido."); return; }

            document.getElementById('step-input').classList.add('hidden');
            document.getElementById('loading-screen').classList.remove('hidden'); document.getElementById('loading-screen').classList.add('flex');
            
            const logs = document.getElementById('loading-logs');
            const logMsg = (m, c='text-cyan-300/70') => {
                logs.innerHTML += `<div class="${c} animate-in slide-in-from-bottom-1">${m}</div>`;
                logs.scrollTop = logs.scrollHeight;
            };

            logMsg("> Inicializando handshake seguro...");
            setTimeout(() => logMsg("> Conectando Solana Mainnet RPC..."), 600);
            setTimeout(() => logMsg("> Verificando assinatura digital...", 'text-yellow-200/80'), 1500);

            try {
                const res = await fetch(`${BACKEND_URL}/verify-payment`, {
                    method: 'POST', headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ signature: sig, session_id: _sessionId })
                });
                const data = await res.json();
                
                if(data.status !== 'success') throw new Error(data.detail);

                logMsg("> SUCESSO. Acessando ANU Quantum Stream...", 'text-green-400');
                setTimeout(() => renderWallet(data), 1500);

            } catch (e) {
                alert("Erro: " + e.message); location.reload();
            }
        }

        // CÁLCULO DE ENTROPIA DE SHANNON (métrica real sobre os bytes recebidos)
        function calculateShannonEntropy(entropyHex) {
            // Conta frequência de cada byte (par de caracteres hex)
            const byteCounts = {};
            let totalBytes = 0;
            for (let i = 0; i < entropyHex.length; i += 2) {
                const byte = entropyHex.substring(i, i + 2).toLowerCase();
                byteCounts[byte] = (byteCounts[byte] || 0) + 1;
                totalBytes++;
            }
            // Calcula entropia de Shannon (bits por byte)
            let entropy = 0;
            for (const count of Object.values(byteCounts)) {
                const p = count / totalBytes;
                if (p > 0) entropy -= p * Math.log2(p);
            }
            // Escala para bits totais da sequência
            return (entropy * totalBytes).toFixed(2);
        }

        function renderWallet(data) {
            document.getElementById('loading-screen').classList.add('hidden');
            document.getElementById('step-result').classList.remove('hidden');

            const localEntropy = ethers.utils.randomBytes(16);
            const serverEntropy = ethers.utils.arrayify(data.entropy.startsWith("0x") ? data.entropy : "0x" + data.entropy);
            const finalEntropy = new Uint8Array(16);
            for(let i=0; i<16; i++) finalEntropy[i] = localEntropy[i] ^ serverEntropy[i];
            const wallet = ethers.Wallet.fromMnemonic(ethers.utils.entropyToMnemonic(finalEntropy));
            
            document.getElementById('seed-grid').innerHTML = wallet.mnemonic.phrase.split(" ").map((w, i) => 
                `<div class="glass-panel p-2 text-center border-slate-700/50 hover:border-cyan-400/50 transition cursor-pointer select-all group">
                    <span class="text-[9px] text-slate-500 block group-hover:text-cyan-400">#${i+1}</span>
                    <span class="text-xs font-bold text-cyan-100 font-inter">${w}</span>
                 </div>`
            ).join('');

            document.getElementById('source-tag').innerHTML = `<span class="indicator-dot bg-cyan-400 animate-pulse-slow"></span> ${data.source}`;
            document.getElementById('latency-tag').innerText = data.latency_ms + " ms";
            
            const shannonBits = calculateShannonEntropy(data.entropy);
            document.getElementById('entropy-score').innerHTML = `<span class="text-green-400 font-bold">${shannonBits} bits</span> (Shannon)`;
            
            const ctx = document.getElementById('quantum-canvas').getContext('2d');
            ctx.canvas.width=300; ctx.canvas.height=40;
            let p=0; for(let x=0;x<300;x+=4) for(let y=0;y<40;y+=4) {
                const v = parseInt(data.entropy[p%data.entropy.length], 16)*16;
                ctx.fillStyle=`rgb(0,${v},${v+60})`; ctx.fillRect(x,y,4,4); p++;
            }
            
            let t=300; const timer=document.getElementById('timer');
            setInterval(()=>{t--; timer.innerText=`${Math.floor(t/60)}:${(t%60).toString().padStart(2,'0')}`; if(t<=0)destroySession()},1000);
        }

        function destroySession() {
            document.body.innerHTML = `<div class="h-screen flex items-center justify-center bg-[#05070a]"><div class="text-center"><h1 class="orbitron text-2xl text-red-500 mb-2">SESSÃO ENCERRADA</h1><button onclick="location.reload()" class="text-xs border border-red-900 px-4 py-2 rounded text-red-300">RECARREGAR</button></div></div>`;
        }
    </script>
</body>
</html>
